{{ define "productions_content" }}
{{ $sortField := .SortProducts.SortField }}
{{ $sortOrder := .SortProducts.SortOrder }}

<div class="d-flex justify-content-between align-items-center">
    <h1 class="h2 mb-3">{{ .Title }}</h1>
</div>

<!-- Карточка с таблицей - всегда отображаем -->
<div class="card shadow-sm">
    <div class="card-body p-0">

        <div class="table-responsive" style="min-width: 1200px;">

            <!-- Добавляем контейнер для скролла -->
            <div style="height: calc(100vh - 400px); overflow-y: auto; position:relative;">
                <table class="table table-hover mb-0" style="min-width: 1200px;" id="productionsTable">

                    <colgroup>
                        <col style="width: 68px">
                        <col style="width: 550px">
                        <col style="width: 500px">
                        <col style="width: 120px">
                        <col style="width: 60px">
                        <col style="width: 60px">
                        <col style="width: 100px">
                        <col style="width: 80px">
                        <col style="width: 110px">
                    </colgroup>

                    <thead class="table-light"
                           style="position: sticky; top: 0; z-index: 10; background-color: #f8f9fa;">
                    <tr>

                        <th class="text-nowrap sortable-header" style="position: relative; padding-bottom: 13px;">
                            <a href="?sort=PrArticle&order={{ if eq $sortField `PrArticle` }}{{ if eq $sortOrder `ASC` }}DESC{{ else }}ASC{{ end }}{{ else }}ASC{{ end }}"
                               class="text-decoration-none text-dark d-block w-100 h-100">
                                Артикул
                                {{ if eq $sortField "PrArticle" }}
                                <span class="sort-indicator">
                                    {{ if eq $sortOrder "ASC" }}↑{{ else }}↓{{ end }}
                                </span>
                                {{ end }}
                            </a>
                        </th>

                        <th class="text-nowrap sortable-header" style="position: relative; padding-bottom: 13px;">
                            <a href="?sort=PrPackName&order={{ if eq $sortField `PrPackName` }}{{ if eq $sortOrder `ASC` }}DESC{{ else }}ASC{{ end }}{{ else }}ASC{{ end }}"
                               class="text-decoration-none text-dark d-block w-100 h-100">
                                Наименование продукции для упаковщика
                                {{ if eq $sortField "PrPackName" }}
                                <span class="sort-indicator">
                                    {{ if eq $sortOrder "ASC" }}↑{{ else }}↓{{ end }}
                                </span>
                                {{ end }}
                            </a>
                        </th>

                        <th class="text-nowrap sortable-header" style="position: relative; padding-bottom: 13px;">
                            <a href="?sort=PrShortName&order={{ if eq $sortField `PrShortName` }}{{ if eq $sortOrder `ASC` }}DESC{{ else }}ASC{{ end }}{{ else }}ASC{{ end }}"
                               class="text-decoration-none text-dark d-block w-100 h-100">
                                Наименование продукции для этикетки
                                {{ if eq $sortField "PrShortName" }}
                                <span class="sort-indicator">
                                    {{ if eq $sortOrder "ASC" }}↑{{ else }}↓{{ end }}
                                </span>
                                {{ end }}
                            </a>
                        </th>

                        <th class="text-nowrap sortable-header text-center" style="position: relative; padding-bottom: 13px;">
                            <a href="?sort=PrColor&order={{ if eq $sortField `PrColor` }}{{ if eq $sortOrder `ASC` }}DESC{{ else }}ASC{{ end }}{{ else }}ASC{{ end }}"
                               class="text-decoration-none text-dark d-block w-100 h-100">
                                Цвет
                                {{ if eq $sortField "PrColor" }}
                                <span class="sort-indicator">
                                    {{ if eq $sortOrder "ASC" }}↑{{ else }}↓{{ end }}
                                </span>
                                {{ end }}
                            </a>
                        </th>

                        <th class="text-nowrap sortable-header text-center" style="position: relative;">
                            <a href="?sort=PrRows&order={{ if eq $sortField `PrRows` }}{{ if eq $sortOrder `ASC` }}DESC{{ else }}ASC{{ end }}{{ else }}ASC{{ end }}"
                               class="text-decoration-none text-dark d-block w-100 h-100">
                                Кол-во <br> рядов
                                {{ if eq $sortField "PrRows" }}
                                <span class="sort-indicator">
                                    {{ if eq $sortOrder "ASC" }}↑{{ else }}↓{{ end }}
                                </span>
                                {{ end }}
                            </a>
                        </th>

                        <th class="text-nowrap sortable-header text-center" style="position: relative;">
                            <a href="?sort=PrCount&order={{ if eq $sortField `PrCount` }}{{ if eq $sortOrder `ASC` }}DESC{{ else }}ASC{{ end }}{{ else }}ASC{{ end }}"
                               class="text-decoration-none text-dark d-block w-100 h-100">
                                Кол-во <br> в ряду
                                {{ if eq $sortField "PrCount" }}
                                <span class="sort-indicator">
                                    {{ if eq $sortOrder "ASC" }}↑{{ else }}↓{{ end }}
                                </span>
                                {{ end }}
                            </a>
                        </th>

                        <th class="text-nowrap text-center text-dark">Габариты <br> упаковки</th>

                        <th class="text-nowrap sortable-header text-center" style="position: relative;">
                            <a href="?sort=idProduction&order={{ if eq $sortField `idProduction` }}{{ if eq $sortOrder `ASC` }}DESC{{ else }}ASC{{ end }}{{ else }}ASC{{ end }}"
                               class="text-decoration-none text-dark d-block w-100 h-100">
                                Код <br> продукции
                                {{ if eq $sortField "idProduction" }}
                                <span class="sort-indicator">
                                    {{ if eq $sortOrder "ASC" }}↑{{ else }}↓{{ end }}
                                </span>
                                {{ end }}
                            </a>
                        </th>

                        <th class="text-nowrap sortable-header text-center" style="position: relative;">
                            <a href="?sort=PrEditDate&order={{ if eq $sortField `PrEditDate` }}{{ if eq $sortOrder `ASC` }}DESC{{ else }}ASC{{ end }}{{ else }}ASC{{ end }}"
                               class="text-decoration-none text-dark d-block w-100 h-100">
                                Дата и время <br> изменение записи
                                {{ if eq $sortField "PrEditDate" }}
                                <span class="sort-indicator">
                                    {{ if eq $sortOrder "ASC" }}↑{{ else }}↓{{ end }}
                                </span>
                                {{ end }}
                            </a>
                        </th>

                    </tr>
                    </thead>
                    <tbody>

                    {{ range .Productions }}
                    <tr>
                        <td>{{ .PrArticle }}</td>
                        <td>{{ .PrPackName }}</td>
                        <td>{{ .PrShortName }}</td>
                        <td class="text-center">{{ .PrColor }}</td>
                        <td class="text-center">{{ .PrRows }}</td>
                        <td class="text-center">{{ .PrCount }}</td>
                        <td>{{ .PrHWD }}</td>
                        <td class="text-center">{{ .IdProduction }}</td>
                        <td>{{ formatDateTime .PrEditDate }}</td>
                    </tr>
                    {{ end }}

                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

{{ end }}